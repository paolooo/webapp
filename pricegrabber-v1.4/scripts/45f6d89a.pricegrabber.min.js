(function(){$.fn.extend({PriceGrabber:function(a){var b,c,d,e,f,g,h;return h=this,a=$.extend({api_url:"/pricegrabber/api.php",template:'<table class="table table-hover"> <tbody> {{#items}} <tr> <td><img src="{{ image }}"></td> <td><img src="{{ rating_image }}"></td> <td>{{ price }}</td> <td><a href="{{ url }}" target="_blank" class="btn btn-primary">Buy</a></td> </tr> {{/items}} </tbody> </table>'},a),b='<div class="'+h.attr("class")+'" id="'+h.attr("id")+'"></div>',c=function(a){return a.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(b)})},g=function(d){var e;return d=c(d),e=$(b).append("<span>Loading...</span>"),b=$(e).insertAfter(h),$.get(a.api_url+"?q="+d)},f=function(a){var b;return b=[],$.each(a,function(a,c){var d;return d=$(c).find("offer"),b=b.concat(e(d))}),b},e=function(a){var b;return b=[],$.each(a,function(a,c){var d,e,f,g;return d=$(c).find("image_small").text()||$(c).find("retailer_logo").text(),g=$(c).find("product > url").text(),e=$($(c).find("price")[0]).text(),f=$(c).find("rating_image").text(),b.push({image:d,url:g,price:e,rating_image:f})}),b},(d=function(c){var d;return d=a.template,g(c).done(function(a,b,c){return $.parseXML(c.responseXML)}).done(function(a){var c,g,h,i,j;return j=$(a),i=j.find("product"),c=$(i).find("offer").length,g=c>0?f(i):e(i),Mustache.parse(d),h=Mustache.render(d,{items:g}),$(b).html(h)})})(a.search)}})}).call(this);